generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Users {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  cpf       String?  @unique
  phone     String?  @unique
  picture   String?
  password  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  categories Categories[]
  accounts   Accounts[]
  feedbacks  Feedbacks[]

  @@map("users")
}

model Categories {
  id     Int    @id @default(autoincrement())
  userId Int?
  name   String
  icon   String
  type   String // EXPENSE, INCOME, ACCOUNT

  user Users? @relation(fields: [userId], references: [id])

  budgets      Budgets[]
  accounts     Accounts[]
  transactions Transactions[]

  @@map("categories")
}

model Accounts {
  id         Int    @id @default(autoincrement())
  userId     Int
  categoryId Int
  name       String
  bank       String

  user     Users      @relation(fields: [userId], references: [id])
  category Categories @relation(fields: [categoryId], references: [id])

  budgets      Budgets[]
  transactions Transactions[]

  @@map("accounts")
}

model Transactions {
  id         Int      @id @default(autoincrement())
  accountId  Int
  categoryId Int
  title      String
  value      Float
  date       DateTime @default(now())
  paid       Boolean  @default(false)

  account  Accounts   @relation(fields: [accountId], references: [id], onUpdate: Cascade, onDelete: Cascade)
  category Categories @relation(fields: [categoryId], references: [id])

  @@map("transactions")
}

model Feedbacks {
  id     Int     @id @default(autoincrement())
  userId Int     @unique
  value  Boolean

  user Users @relation(fields: [userId], references: [id])

  createdAt DateTime @default(now())

  @@map("feedbacks")
}

model Budgets {
  id         Int      @id @default(autoincrement())
  accountId  Int
  categoryId Int
  title      String
  value      Float
  date       DateTime @default(now())

  account  Accounts   @relation(fields: [accountId], references: [id])
  category Categories @relation(fields: [categoryId], references: [id])

  @@map("budgets")
}
